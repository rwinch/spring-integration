<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SMB Support :: Spring Integration</title>
    <link rel="prev" href="sftp/remote-file-info.html">
    <link rel="next" href="stomp.html">
    <meta name="generator" content="Antora 3.2.0-alpha.2">
    <script>
!function (theme, navWidth) {
  if (theme === 'dark') document.documentElement.classList.add('dark-theme')
  if (navWidth) document.documentElement.style.setProperty('--nav-width', `${navWidth}px`)
}(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)') && 'dark'),
  localStorage && localStorage.getItem('nav-width'))
    </script>
    <link rel="stylesheet" href="./_/css/site.css">
    <link rel="stylesheet" href="./_/css/vendor/search.css">
    <link rel="stylesheet" href="./_/css/vendor/asciidoctor-tabs.css">

    <meta name="version" content="6.2.0">
    <meta name="component" content="integration">
    <link rel="icon" href="./_/img/favicon.ico" type="image/vnd.microsoft.icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://spring.io">
        <img
          id="springlogo"
          class="block"
          src="./_/img/spring-logo.svg"
          alt="Spring"
        />
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Why Spring</a>
          <div class="navbar-dropdown">
            <a
              class="navbar-item"
              href="https://spring.io/why-spring"
            >Overview</a>
            <a
              class="navbar-item"
              href="https://spring.io/microservices"
            >Microservices</a>
            <a
              class="navbar-item"
              href="https://spring.io/reactive"
            >Reactive</a>
            <a class="navbar-item" href="https://spring.io/event-driven">Event
              Driven</a>
            <a class="navbar-item" href="https://spring.io/cloud">Cloud</a>
            <a class="navbar-item" href="https://spring.io/web-applications">Web
              Applications</a>
            <a
              class="navbar-item"
              href="https://spring.io/serverless"
            >Serverless</a>
            <a class="navbar-item" href="https://spring.io/batch">Batch</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Learn</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://spring.io/learn">Overview</a>
            <a
              class="navbar-item"
              href="https://spring.io/quickstart"
            >Quickstart</a>
            <a class="navbar-item" href="https://spring.io/guides">Guides</a>
            <a class="navbar-item" href="https://spring.io/blog">Blog</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Projects</a>
          <div class="navbar-dropdown" style="min-width: 280px">
            <a
              class="navbar-item"
              href="https://spring.io/projects"
            >Overview</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-boot"
            >Spring Boot</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-framework"
            >Spring Framework</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-cloud"
            >Spring Cloud</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-cloud-dataflow"
            >Spring Cloud Data Flow</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-data"
            >Spring Data</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-integration"
            >Spring Integration</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-batch"
            >Spring Batch</a>
            <a
              class="navbar-item"
              href="https://spring.io/projects/spring-security"
            >Spring Security</a>
            <a
              class="navbar-item navbar-item-special"
              href="https://spring.io/projects"
            >View all projects</a>
            <a class="navbar-item" href="https://spring.io/tools">Spring Tools 4</a>
            <a
              class="navbar-item navbar-item-special-2"
              href="https://start.spring.io"
            >Spring Initializr
              <svg
                class="external-link-icon"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 16 16"
              ><polyline
                  points="15 10.94 15 15 1 15 1 1 5.06 1"
                  fill="none"
                  stroke="currentColor"
                  stroke-miterlimit="10"
                  stroke-width="2"
                ></polyline><polyline
                  points="8.93 1 15 1 15 7.07"
                  fill="none"
                  stroke="currentColor"
                  stroke-miterlimit="10"
                  stroke-width="2"
                ></polyline><line
                  x1="15"
                  y1="1"
                  x2="8"
                  y2="8"
                  fill="none"
                  stroke="currentColor"
                  stroke-miterlimit="10"
                  stroke-width="2"
                ></line></svg></a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Academy</a>
          <div class="navbar-dropdown">
            <a
              class="navbar-item"
              href="https://spring.academy/courses"
            >Courses</a>
            <a
              class="navbar-item"
              href="https://spring.academy/learning-path"
            >Get Certified</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Support</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://spring.io/support">Overview</a>
            <a class="navbar-item" href="https://spring.io/security">Security
              Advisories</a>
          </div>
        </div>

        <div class="navbar-item has-dropdown is-hoverable is-community">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a
              class="navbar-item"
              href="https://spring.io/community"
            >Overview</a>
            <a class="navbar-item" href="https://spring.io/events">Events</a>
            <a class="navbar-item" href="https://spring.io/team">Team</a>
          </div>
        </div>
      </div>
    </div>
    <label class="theme-toggler">
      <input
        type="checkbox"
        type="checkbox"
        id="switch-theme-checkbox"
        name="switch-theme-checkbox"
      />
      <span class="icon"><svg
          aria-hidden="true"
          focusable="false"
          data-prefix="fas"
          data-icon="moon"
          class="svg-inline--fa fa-moon moon"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 384 512"
        ><path
            fill="currentColor"
            d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"
          ></path>
        </svg>
        <svg
          aria-hidden="true"
          focusable="false"
          data-prefix="fas"
          data-icon="sun"
          class="svg-inline--fa fa-sun sun"
          role="img"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 512 512"
        ><path
            fill="currentColor"
            d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"
          ></path>
        </svg></span>
      <span class="text">light</span>
    </label>
  </nav>
</header>
<script>
!function (theme) {
  if (theme === 'dark') {
    document.getElementById('switch-theme-checkbox').parentElement.classList.add('active')
  }
}(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)') && 'dark'))
</script><div class="body">
<div class="nav-container" data-component="integration" data-version="6.2.0">
  <aside class="nav">
    <div class="panels">
      <div class="nav-panel-menu is-active" data-panel="menu">
        <nav class="nav-menu">
<div class="context">
  <span class="title">Spring Integration</span>
  <span class="version">6.2.0-SNAPSHOT</span>
  <button class="browse-version" id="browse-version">
    <svg
      height="24px"
      id="Layer_1"
      style="enable-background:new 0 0 512 512;"
      version="1.1"
      viewBox="0 0 512 512"
      width="24px"
      xml:space="preserve"
    ><g><path
          d="M256,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S273.7,224,256,224L256,224z"
        ></path><path
          d="M128.4,224c-17.7,0-32,14.3-32,32s14.3,32,32,32c17.7,0,32-14.3,32-32S146,224,128.4,224L128.4,224z"
        ></path><path
          d="M384,224c-17.7,0-32,14.3-32,32s14.3,32,32,32s32-14.3,32-32S401.7,224,384,224L384,224z"
        ></path></g></svg>
  </button>
</div><div class="search">
  <button class="DocSearch-Button search-button">
    <svg enable-background="new 0 0 32 32" id="Glyph" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path d="M27.414,24.586l-5.077-5.077C23.386,17.928,24,16.035,24,14c0-5.514-4.486-10-10-10S4,8.486,4,14  s4.486,10,10,10c2.035,0,3.928-0.614,5.509-1.663l5.077,5.077c0.78,0.781,2.048,0.781,2.828,0  C28.195,26.633,28.195,25.367,27.414,24.586z M7,14c0-3.86,3.14-7,7-7s7,3.14,7,7s-3.14,7-7,7S7,17.86,7,14z" id="XMLID_223_"/>
    </svg>
    <span>Search</span>
    <span class="search-key"></span>
  </button>
</div>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="preface.html">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="whats-new.html">What&#8217;s New?</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="core.html">Core Messaging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="channel.html">Message Channels</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel/interfaces.html">The MessageChannel Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel/implementations.html">Message Channel Implementations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel/interceptors.html">Channel Interceptors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel/template.html"><code>MessagingTemplate</code></a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel/configuration.html">Configuring Message Channels</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="channel/special-channels.html">Special Channels</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="polling-consumer.html">Poller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="channel-adapter.html">Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bridge.html">Messaging Bridge</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="message.html">Message</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="message-routing.html">Message Routing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="router.html">Routers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/common-parameters.html">Common Router Parameters</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/implementations.html">Router Implementations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/namespace.html">Configuring a Generic Router</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/spel.html">Routers and the Spring Expression Language (SpEL)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/annotation.html">Configuring a Router with Annotations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/dynamic-routers.html">Dynamic Routers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/routing-slip.html">Routing Slip</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="router/process-manager.html">Process Manager Enterprise Integration Pattern</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="filter.html">Filter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="splitter.html">Splitter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="aggregator.html">Aggregator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resequencer.html">Resequencer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="chain.html">Message Handler Chain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scatter-gather.html">Scatter-Gather</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="barrier.html">Thread Barrier</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="message-transformation.html">Message Transformation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="transformer.html">Transformer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="content-enrichment.html">Content Enricher</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="claim-check.html">Claim Check</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="codec.html">Codec</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="messaging-endpoints.html">Messaging Endpoints</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endpoint.html">Message Endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="endpoint-roles.html">Endpoint Roles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="leadership-event-handling.html">Leadership Event Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="gateway.html">Messaging Gateways</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="service-activator.html">Service Activator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="delayer.html">Delayer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="scripting.html">Scripting Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="groovy.html">Groovy Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="handler-advice.html">Adding Behavior to Endpoints</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/classes.html">Provided Advice Classes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/reactive.html">Reactive Advice</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/context-holder.html">Context Holder Advice</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/custom.html">Custom Advice Classes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/other.html">Other Advice Chain Elements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/handle-message.html">Handling Message Advice</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/tx-handle-message.html">Transaction Support</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/advising-filters.html">Advising Filters</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/advising-with-annotations.html">Advising Endpoints Using Annotations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/order.html">Ordering Advices within Advice Chain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/advised-properties.html">Advised Handler Properties</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handler-advice/idempotent-receiver.html">Idempotent Receiver Enterprise Integration Pattern</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="logging-adapter.html">Logging Channel Adapter</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="functions-support.html"><code>java.util.function</code> Interfaces Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="kotlin-functions.html">Kotlin Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="dsl.html">Java DSL</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-basics.html">DSL Basics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-channels.html">Message Channels</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-pollers.html">Pollers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-reactive.html">The <code>reactive()</code> Endpoint</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-endpoints.html">DSL and Endpoint Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-transformers.html">Transformers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-inbound-adapters.html">Inbound Channel Adapters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-routers.html">Message Routers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-splitters.html">Splitters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-aggregators.html">Aggregators and Resequencers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-handle.html">Service Activators and the <code>.handle()</code> method</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-gateway.html">Operator gateway()</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-log.html">Operator log()</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-intercept.html">Operator intercept()</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-wiretap.html"><code>MessageChannelSpec.wireTap()</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-flows.html">Working With Message Flows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-function-expression.html"><code>FunctionExpression</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-subflows.html">Sub-flows support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-protocol-adapters.html">Using Protocol Adapters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-flow-adapter.html"><code>IntegrationFlowAdapter</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-runtime-flows.html">Dynamic and Runtime Integration Flows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/integration-flow-as-gateway.html"><code>IntegrationFlow</code> as a Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/java-extensions.html">DSL Extensions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dsl/integration-flows-composition.html">Integration Flows Composition</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="groovy-dsl.html">Groovy DSL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="kotlin-dsl.html">Kotlin DSL</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="system-management.html">System Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="metrics.html">Metrics and Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-history.html">Message History</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="message-store.html">Message Store</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="meta-data-store.html">Metadata Store</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="control-bus.html">Control Bus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="shutdown.html">Orderly Shutdown</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="graph.html">Integration Graph</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="integration-graph-controller.html">Integration Graph Controller</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="reactive-streams.html">Reactive Streams Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="native-aot.html">Native Images Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="endpoint-summary.html">Integration Endpoints</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="amqp.html">AMQP Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/inbound-channel-adapter.html">Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/polled-inbound-channel-adapter.html">Polled Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/inbound-gateway.html">Inbound Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/inbound-ack.html">Inbound Endpoint Acknowledge Mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/outbound-endpoints.html">Outbound Endpoints</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/outbound-channel-adapter.html">Outbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/outbound-gateway.html">Outbound Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/async-outbound-gateway.html">Asynchronous Outbound Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/alternative-confirms-returns.html">Alternative Mechanism for Publisher Confirms and Returns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/conversion-inbound.html">Inbound Message Conversion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/content-type-conversion-outbound.html">Outbound Message Conversion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/user-id.html">Outbound User ID</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/delay.html">Delayed Message Exchange</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/channels.html">AMQP-backed Message Channels</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/message-headers.html">AMQP Message Headers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/strict-ordering.html">Strict Message Ordering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/samples.html">AMQP Samples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="amqp/rmq-streams.html">RabbitMQ Stream Queue Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="camel.html">Apache Camel Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cassandra.html">Apache Cassandra Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="debezium.html">Debezium Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="event.html">Spring <code>ApplicationEvent</code> Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="feed.html">Feed Adapter</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="file.html">File Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file/reading.html">Reading Files</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file/writing.html">Writing files</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file/transforming.html">File Transformers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file/splitter.html">File Splitter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file/aggregator.html">File Aggregator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="file/remote-persistent-flf.html">Remote Persistent File List Filters</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="ftp.html">FTP/FTPS Adapters</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/session-factory.html">FTP Session Factory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/advanced-configuration.html">Advanced Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/dsf.html">Delegating Session Factory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/inbound.html">FTP Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/streaming.html">FTP Streaming Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/rotating-server-advice.html">Inbound Channel Adapters: Polling Multiple Servers and Directories</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/max-fetch.html">Inbound Channel Adapters: Controlling Remote File Fetching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/outbound.html">FTP Outbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/outbound-gateway.html">FTP Outbound Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/session-caching.html">FTP Session Caching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/rft.html">Using <code>RemoteFileTemplate</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/session-callback.html">Using <code>MessageSessionCallback</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/server-events.html">Apache Mina FTP Server Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ftp/remote-file-info.html">Remote File Information</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="graphql.html">GraphQL Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="hazelcast.html">Hazelcast Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="http.html">HTTP Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/inbound.html">Http Inbound Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/outbound.html">HTTP Outbound Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/namespace.html">HTTP Namespace Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/java-config.html">Configuring HTTP Endpoints with Java</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/timeout.html">Timeout Handling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/proxy.html">HTTP Proxy configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/header-mapping.html">HTTP Header Mappings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/int-graph-controller.html">Integration Graph Controller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="http/samples.html">HTTP Samples</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="jdbc.html">JDBC Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc/inbound-channel-adapter.html">Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc/outbound-channel-adapter.html">Outbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc/outbound-gateway.html">Outbound Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc/message-store.html">JDBC Message Store</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc/stored-procedures.html">Stored Procedures</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc/lock-registry.html">JDBC Lock Registry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jdbc/metadata-store.html">JDBC Metadata Store</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="jpa.html">JPA Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jpa/functionality.html">Functionality</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jpa/supported-persistence-providers.html">Supported Persistence Providers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jpa/java-implementation.html">Java Implementation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jpa/namespace-support.html">Namespace Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jpa/inbound-channel-adapter.html">Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jpa/outbound-channel-adapter.html">Outbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jpa/outbound-gateways.html">Outbound Gateways</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jms.html">JMS Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jmx.html">JMX Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="kafka.html">Apache Kafka Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="mail.html">Mail Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="mongodb.html">MongoDb Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="mqtt.html">MQTT Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="r2dbc.html">R2DBC Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="redis.html">Redis Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resource.html">Resource Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="rsocket.html">RSocket Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="sftp.html">SFTP Adapters</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/session-factory.html">SFTP Session Factory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/dsf.html">Delegating Session Factory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/session-caching.html">SFTP Session Caching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/rft.html">Using <code>RemoteFileTemplate</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/inbound.html">SFTP Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/streaming.html">SFTP Streaming Inbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/rotating-server-advice.html">Inbound Channel Adapters: Polling Multiple Servers and Directories</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/max-fetch.html">Inbound Channel Adapters: Controlling Remote File Fetching</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/outbound.html">SFTP Outbound Channel Adapter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/outbound-gateway.html">SFTP Outbound Gateway</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/session-callback.html">MessageSessionCallback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/server-events.html">Apache Mina SFTP Server Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sftp/remote-file-info.html">Remote File Information</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="smb.html">SMB Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="stomp.html">STOMP Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="stream.html">Stream Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="syslog.html">Syslog Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="ip.html">TCP and UDP Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/udp-adapters.html">UDP Adapters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/tcp-connection-factories.html">TCP Connection Factories</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/testing-connections.html">Testing Connections</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/interceptors.html">TCP Connection Interceptors</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/tcp-events.html">TCP Connection Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/tcp-adapters.html">TCP Adapters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/tcp-gateways.html">TCP Gateways</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/correlation.html">TCP Message Correlation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/note-nio.html">About Non-blocking I/O (NIO)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/ssl-tls.html">SSL/TLS Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/tcp-advanced-techniques.html">Advanced Techniques</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/endpoint-reference.html">IP Configuration Attributes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/msg-headers.html">IP Message Headers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/annotation.html">Annotation-Based Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ip/dsl.html">Using the Java DSL for TCP Components</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="webflux.html">WebFlux Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="web-sockets.html">WebSockets Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ws.html">Web Services Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="xml.html">XML Support - Dealing with XML Payloads</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/xpath-namespace-support.html">Namespace Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/transformation.html">Transforming XML Payloads</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/xpath-transformer.html">Transforming XML Messages with XPath</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/xpath-splitting.html">Splitting XML Messages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/xpath-routing.html">Routing XML Messages with XPath</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/xpath-header-enricher.html">XPath Header Enricher</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/xpath-filter.html">Using the XPath Filter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/xpath-spel-function.html">#xpath SpEL Function</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="xml/validating-filter.html">XML Validating Filter</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="xmpp.html">XMPP Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="zeromq.html">ZeroMQ Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="zookeeper.html">Zookeeper Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="error-handling.html">Error Handling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="spel.html">Spring Expression Language (SpEL)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="message-publishing.html">Message Publishing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="transactions.html">Transaction Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="security.html">Security in Spring Integration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="configuration.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration/namespace.html">Namespace Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration/namespace-taskscheduler.html">Configuring the Task Scheduler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration/global-properties.html">Global Properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration/annotations.html">Annotation Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration/meta-annotations.html">Messaging Meta-Annotations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="configuration/message-mapping-rules.html">Message Mapping Rules and Conventions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="testing.html">Testing support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="samples.html">Spring Integration Samples</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="resources.html">Additional Resources</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="history.html">Change History</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-6.0-6.1.html">Changes between 6.0 and 6.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-5.5-6.0.html">Changes between 5.5 and 6.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-5.4-5.5.html">Changes between 5.4 and 5.5</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-5.3-5.4.html">Changes between 5.3 and 5.4</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-5.2-5.3.html">Changes between 5.2 and 5.3</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-5.1-5.2.html">Changes between 5.1 and 5.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-5.0-5.1.html">Changes between 5.0 and 5.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-4.3-5.0.html">Changes between 4.3 and 5.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-4.2-4.3.html">Changes between 4.2 and 4.3</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-4.1-4.2.html">Changes between 4.1 and 4.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-4.0-4.1.html">Changes between 4.0 and 4.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-3.0-4.0.html">Changes between 3.0 and 4.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-2.2-3.0.html">Changes Between 2.2 and 3.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-2.1-2.2.html">Changes between 2.1 and 2.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-2.0-2.1.html">Changes between 2.0 and 2.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="changes-1.0-2.0.html">Changes between Versions 1.0 and 2.0</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="zip.html">Zip Support</a>
  </li>
</ul>
  </li>
</ul>
          <div class="toggle-sm">
            <button id="nav-toggle-2" class="nav-toggle"></button>
          </div>
        </nav>
      </div>
      <div class="nav-collapse">
        <button id="nav-collapse-toggle"><span></span></button>        
      </div>
    </div>
    <div class="nav-resize"></div>
  </aside>
</div>
<script>
!function (sidebar) {
  if (sidebar) {
    document.body.classList.add('nav-sm')
  }
}(localStorage && localStorage.getItem('sidebar') === 'close')
</script><main class="article">
<div class="toolbar" role="navigation">
  <button id="nav-toggle-1" class="nav-toggle"></button>
<div class="search">
  <button class="DocSearch-Button search-button">
    <svg enable-background="new 0 0 32 32" id="Glyph" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path d="M27.414,24.586l-5.077-5.077C23.386,17.928,24,16.035,24,14c0-5.514-4.486-10-10-10S4,8.486,4,14  s4.486,10,10,10c2.035,0,3.928-0.614,5.509-1.663l5.077,5.077c0.78,0.781,2.048,0.781,2.828,0  C28.195,26.633,28.195,25.367,27.414,24.586z M7,14c0-3.86,3.14-7,7-7s7,3.14,7,7s-3.14,7-7,7S7,17.86,7,14z" id="XMLID_223_"/>
    </svg>
    <span>Search</span>
    <span class="search-key"></span>
  </button>
</div>
</div>
  <div class="content">
<aside class="sidebar">
  <div class="content">
    <div
      class="toc"
      data-title="SMB Support"
      data-levels="2"
    >
      <div class="toc-menu"></div>
    </div>
    <div class="sidebar-links">
        <a href="https://github.com/rwinch/spring-integration/edit/main/modules/ROOT/pages/smb.adoc">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="24"
            viewBox="0 0 24 24"
            width="24"
          ><path
              d="m16 2.012 3 3L16.713 7.3l-3-3zM4 14v3h3l8.299-8.287-3-3zm0 6h16v2H4z"
            ></path></svg>
          Edit this Page
        </a>
              <a href="https://github.com/rwinch/spring-integration" title="Github">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="512px"
            id="Layer_1"
            version="1.1"
            viewBox="0 0 512 512"
            width="512px"
          ><style type="text/css"><![CDATA[
              .st0{fill-rule:evenodd;clip-rule:evenodd;} ]]></style><g><path
                class="st0"
                d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"
              ></path></g></svg>
          Github Project
        </a>
        <a href="https://stackoverflow.com/tags/spring-integration">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path
              d="M290.7 311L95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"
            ></path></svg>
          Stack Overflow
        </a>
    </div>
  </div>
</aside><div class="doc">
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Spring Integration</a></li>
    <li><a href="smb.html">SMB Support</a></li>
  </ul>
</nav>
<article>
<h1 id="page-title" class="page">SMB Support</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Spring Integration provides support for file transfer operations with SMB.</p>
</div>
<div class="paragraph">
<p>The <a href="https://en.wikipedia.org/wiki/Server_Message_Block">Server Message Block</a> (SMB) is a simple network protocol that lets you transfer files to a shared file server.</p>
</div>
<div class="paragraph">
<p>You need to include this dependency into your project:</p>
</div>
<div id="_tabs_1" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_1_maven" class="tab">
<p>Maven</p>
</li>
<li id="_tabs_1_gradle" class="tab">
<p>Gradle</p>
</li>
</ul>
</div>
<div id="_tabs_1_maven--panel" class="tabpanel" aria-labelledby="_tabs_1_maven">
<div class="listingblock primary">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.integration&lt;/groupId&gt;
    &lt;artifactId&gt;spring-integration-smb&lt;/artifactId&gt;
    &lt;version&gt;6.2.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_1_gradle--panel" class="tabpanel" aria-labelledby="_tabs_1_gradle">
<div class="listingblock secondary">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">compile "org.springframework.integration:spring-integration-smb:6.2.0-SNAPSHOT"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://github.com/codelibs/jcifs">Java CIFS</a> Client Library has been chosen as a Java implementation for the CIFS/SMB networking protocol.
Its <code>SmbFile</code> abstraction is simply wrapped to the Spring Integration "Remote File" foundations like <code>SmbSession</code>, <code>SmbRemoteFileTemplate</code>, etc.</p>
</div>
<div class="paragraph">
<p>The SMB Channel Adapters and support classes implementations are fully similar to existing components for (S)FTP or AWS S3 protocols.
So, if you familiar with those components it is pretty straightforward to use.</p>
</div>
<div class="paragraph">
<p>Spring Integration supports sending and receiving files over SMB by providing three client-side endpoints: inbound channel adapter, outbound channel adapter, and outbound gateway.
It also provides convenient namespace-based configuration options for defining these client components.</p>
</div>
<div class="paragraph">
<p>To use the SMB namespace, add the following to the header of your XML file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">xmlns:int-smb="http://www.springframework.org/schema/integration/smb"
xsi:schemaLocation="http://www.springframework.org/schema/integration/smb
    https://www.springframework.org/schema/integration/smb/spring-integration-smb.xsd"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smb-session-factory"><a class="anchor" href="#smb-session-factory"></a>SMB Session Factory</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before configuring the SMB adapter, you must configure an SMB session factory.
You can configure the SMB session factory with a regular bean definition, as the following examples show:</p>
</div>
<div class="paragraph">
<p>The <code>SmbSessionFactory</code> exposes options to set the SMB protocol with Min/Max versions.
For example, supporting a minimum version of SMB 2.1 and a maximum version of the SMB 3.1.1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
public SmbSessionFactory smbSessionFactory() {
    SmbSessionFactory smbSession = new SmbSessionFactory();
    smbSession.setHost("myHost");
    smbSession.setPort(445);
    smbSession.setDomain("myDomain");
    smbSession.setUsername("myUser");
    smbSession.setPassword("myPassword");
    smbSession.setShareAndDir("myShareAndDir");
    smbSession.setSmbMinVersion(DialectVersion.SMB210);
    smbSession.setSmbMaxVersion(DialectVersion.SMB311);
    return smbSession;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>SmbSessionFactory</code> can be initialized with a custom <code>jcifs.CIFSContext</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Setting of the SMB protocol Min/Max versions must be done in your implementation of <code>jcifs.CIFSContext</code>.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
public SmbSessionFactory smbSessionFactory() {
    SmbSessionFactory smbSession = new SmbSessionFactory(new MyCIFSContext());
    smbSession.setHost("myHost");
    smbSession.setPort(445);
    smbSession.setDomain("myDomain");
    smbSession.setUsername("myUser");
    smbSession.setPassword("myPassword");
    smbSession.setShareAndDir("myShareAndDir");
    return smbSession;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smb-inbound"><a class="anchor" href="#smb-inbound"></a>SMB Inbound Channel Adapter</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To download SMB files locally the <code>SmbInboundFileSynchronizingMessageSource</code> is provided.
It is simple extension of the <code>AbstractInboundFileSynchronizingMessageSource</code> which  requires <code>SmbInboundFileSynchronizer</code> injection.
For filtering remote files you still can use any existing <code>FileListFilter</code> implementations, but particular <code>SmbRegexPatternFileListFilter</code> and <code>SmbSimplePatternFileListFilter</code> are provided.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
public SmbInboundFileSynchronizer smbInboundFileSynchronizer() {
    SmbInboundFileSynchronizer fileSynchronizer =
        new SmbInboundFileSynchronizer(smbSessionFactory());
    fileSynchronizer.setFilter(compositeFileListFilter());
    fileSynchronizer.setRemoteDirectory("mySharedDirectoryPath");
    fileSynchronizer.setDeleteRemoteFiles(true);
    return fileSynchronizer;
}

@Bean
public CompositeFileListFilter&lt;SmbFile&gt; compositeFileListFilter() {
    CompositeFileListFilter&lt;SmbFile&gt; filters = new CompositeFileListFilter&lt;&gt;();
    filters.addFilter(new SmbRegexPatternFileListFilter("^(?i).+((\\.txt))$"));
    return filters;
}

@Bean
public MessageChannel smbFileInputChannel() {
    return new DirectChannel();
}

@Bean
@InboundChannelAdapter(value = "smbFileInputChannel",
                       poller = @Poller(fixedDelay = "2000"))
public MessageSource&lt;File&gt; smbMessageSource() {
    SmbInboundFileSynchronizingMessageSource messageSource =
        new SmbInboundFileSynchronizingMessageSource(smbInboundFileSynchronizer());
    messageSource.setLocalDirectory(new File("myLocalDirectoryPath"));
    messageSource.setAutoCreateLocalDirectory(true);
    return messageSource;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For XML configuration the <code>&lt;int-smb:inbound-channel-adapter&gt;</code> component is provided.</p>
</div>
<div class="sect2">
<h3 id="configuring-with-the-java-dsl"><a class="anchor" href="#configuring-with-the-java-dsl"></a>Configuring with the Java DSL</h3>
<div class="paragraph">
<p>The following Spring Boot application shows an example of how to configure the inbound adapter with the Java DSL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootApplication
public class SmbJavaApplication {

    public static void main(String[] args) {
        new SpringApplicationBuilder(SmbJavaApplication.class)
            .web(false)
            .run(args);
    }

    @Bean
    public SmbSessionFactory smbSessionFactory() {
        SmbSessionFactory smbSession = new SmbSessionFactory();
        smbSession.setHost("myHost");
        smbSession.setPort(445);
        smbSession.setDomain("myDomain");
        smbSession.setUsername("myUser");
        smbSession.setPassword("myPassword");
        smbSession.setShareAndDir("myShareAndDir");
        smbSession.setSmbMinVersion(DialectVersion.SMB210);
        smbSession.setSmbMaxVersion(DialectVersion.SMB311);
        return smbSession;
    }

    @Bean
    public IntegrationFlow smbInboundFlow() {
        return IntegrationFlow
            .from(Smb.inboundAdapter(smbSessionFactory())
                    .preserveTimestamp(true)
                    .remoteDirectory("smbSource")
                    .regexFilter(".*\\.txt$")
                    .localFilename(f -&gt; f.toUpperCase() + ".a")
                    .localDirectory(new File("d:\\smb_files")),
                        e -&gt; e.id("smbInboundAdapter")
                    .autoStartup(true)
                    .poller(Pollers.fixedDelay(5000)))
            .handle(m -&gt; System.out.println(m.getPayload()))
            .get();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smb-streaming-inbound"><a class="anchor" href="#smb-streaming-inbound"></a>SMB Streaming Inbound Channel Adapter</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This adapter produces message with payloads of type <code>InputStream</code>, letting files be fetched without writing to the local file system.
Since the session remains open, the consuming application is responsible for closing the session when the file has been consumed.
The session is provided in the <code>closeableResource</code> header (<code>IntegrationMessageHeaderAccessor.CLOSEABLE_RESOURCE</code>).
Standard framework components, such as the <code>FileSplitter</code> and <code>StreamTransformer</code>, automatically close the session.
See <a href="file/splitter.html" class="xref page">File Splitter</a> and <a href="transformer.html#stream-transformer" class="xref page">Stream Transformer</a> for more information about these components.
The following example shows how to configure an <code>inbound-streaming-channel-adapter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;int-smb:inbound-streaming-channel-adapter id="smbInbound"
            channel="smbChannel"
            session-factory="sessionFactory"
            filename-pattern="*.txt"
            filename-regex=".*\.txt"
            filter="filter"
            filter-expression="@myFilterBean.check(#root)"
            remote-file-separator="/"
            comparator="comparator"
            max-fetch-size="1"
            remote-directory-expression="'foo/bar'"&gt;
        &lt;int:poller fixed-rate="1000" /&gt;
&lt;/int-smb:inbound-streaming-channel-adapter&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only one of <code>filename-pattern</code>, <code>filename-regex</code>, <code>filter</code>, or <code>filter-expression</code> is allowed.</p>
</div>
<div class="paragraph">
<p>The <code>SmbStreamingMessageSource</code> adapter prevents duplicates for remote files with <code>SmbPersistentAcceptOnceFileListFilter</code> based on the in-memory <code>SimpleMetadataStore</code>.
By default, this filter is also applied with the filename pattern (or regex).
If you need to allow duplicates, you can use <code>AcceptAllFileListFilter</code>.
Any other use cases can be handled by <code>CompositeFileListFilter</code> (or <code>ChainFileListFilter</code>).
The Java configuration (<a href="#smb-streaming-java">later in the document</a>) shows one technique to remove the remote file after processing to avoid duplicates.</p>
</div>
<div class="paragraph">
<p>For more information about the <code>SmbPersistentAcceptOnceFileListFilter</code>, and how it is used, see <a href="file/remote-persistent-flf.html" class="xref page">Remote Persistent File List Filters</a>.</p>
</div>
<div class="paragraph">
<p>Use the <code>max-fetch-size</code> attribute to limit the number of files fetched on each poll when a fetch is necessary.
Set it to <code>1</code> and use a persistent filter when running in a clustered environment.
See <a href="#smb-max-fetch">Inbound Channel Adapters: Controlling Remote File Fetching</a> for more information.</p>
</div>
<div class="paragraph">
<p>The adapter puts the remote directory and file name in the <code>FileHeaders.REMOTE_DIRECTORY</code> and <code>FileHeaders.REMOTE_FILE</code> headers, respectively.
The <code>FileHeaders.REMOTE_FILE_INFO</code> header provides additional remote file information (represented in JSON by default).
If you set the <code>fileInfoJson</code> property on the <code>SmbStreamingMessageSource</code> to <code>false</code>, the header contains an <code>SmbFileInfo</code> object.</p>
</div>
<div class="sect2">
<h3 id="smb-streaming-java"><a class="anchor" href="#smb-streaming-java"></a>Configuring with Java Configuration</h3>
<div class="paragraph">
<p>The following Spring Boot application shows an example of how to configure the inbound adapter with Java configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootApplication
public class SmbJavaApplication {

    public static void main(String[] args) {
        new SpringApplicationBuilder(SmbJavaApplication.class)
            .web(false)
            .run(args);
    }

    @Bean
    @InboundChannelAdapter(channel = "stream")
    public MessageSource&lt;InputStream&gt; smbMessageSource() {
        SmbStreamingMessageSource messageSource = new SmbStreamingMessageSource(template());
        messageSource.setRemoteDirectory("smbSource/");
        messageSource.setFilter(new AcceptAllFileListFilter&lt;&gt;());
        messageSource.setMaxFetchSize(1);
        return messageSource;
    }

    @Bean
    @Transformer(inputChannel = "stream", outputChannel = "data")
    public org.springframework.integration.transformer.Transformer transformer() {
        return new StreamTransformer("UTF-8");
    }

    @Bean
    public SmbRemoteFileTemplate template() {
        return new SmbRemoteFileTemplate(smbSessionFactory());
    }

    @ServiceActivator(inputChannel = "data", adviceChain = "after")
    @Bean
    public MessageHandler handle() {
        return System.out::println;
    }

    @Bean
    public ExpressionEvaluatingRequestHandlerAdvice after() {
        ExpressionEvaluatingRequestHandlerAdvice advice = new ExpressionEvaluatingRequestHandlerAdvice();
        advice.setOnSuccessExpression(
                "@template.remove(headers['file_remoteDirectory'] + headers['file_remoteFile'])");
        advice.setPropagateEvaluationFailures(true);
        return advice;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that, in this example, the message handler downstream of the transformer has an <code>advice</code> that removes the remote file after processing.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smb-max-fetch"><a class="anchor" href="#smb-max-fetch"></a>Inbound Channel Adapters: Controlling Remote File Fetching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are two properties that you should consider when you configure inbound channel adapters.
<code>max-messages-per-poll</code>, as with all pollers, can be used to limit the number of messages emitted on each poll (if more than the configured value are ready).
<code>max-fetch-size</code> can limit the number of files retrieved from the remote server at one time.</p>
</div>
<div class="paragraph">
<p>The following scenarios assume the starting state is an empty local directory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>max-messages-per-poll=2</code> and <code>max-fetch-size=1</code>: The adapter fetches one file, emits it, fetches the next file, emits it, and then sleeps until the next poll.</p>
</li>
<li>
<p><code>max-messages-per-poll=2</code> and <code>max-fetch-size=2</code>): The adapter fetches both files and then emits each one.</p>
</li>
<li>
<p><code>max-messages-per-poll=2</code> and <code>max-fetch-size=4</code>: The adapter fetches up to four files (if available) and emits the first two (if there are at least two).
The next two files are emitted on the next poll.</p>
</li>
<li>
<p><code>max-messages-per-poll=2</code> and <code>max-fetch-size</code> not specified: The adapter fetches all remote files and emits the first two (if there are at least two).
The subsequent files are emitted on subsequent polls (two at a time).
When all files are consumed, the remote fetch is attempted again, to pick up any new files.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When you deploy multiple instances of an application, we recommend a small <code>max-fetch-size</code>, to avoid one instance &#8220;grabbing&#8221; all the files and starving other instances.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another use for <code>max-fetch-size</code> is if you want to stop fetching remote files but continue to process files that have already been fetched.
Setting the <code>maxFetchSize</code> property on the <code>MessageSource</code> (programmatically, with JMX, or with a <a href="groovy.html#groovy-control-bus" class="xref page">control bus</a>) effectively stops the adapter from fetching more files but lets the poller continue to emit messages for files that have previously been fetched.
If the poller is active when the property is changed, the change takes effect on the next poll.</p>
</div>
<div class="paragraph">
<p>The synchronizer can be provided with a <code>Comparator&lt;SmbFile&gt;</code>.
This is useful when restricting the number of files fetched with <code>maxFetchSize</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smb-outbound"><a class="anchor" href="#smb-outbound"></a>SMB Outbound Channel Adapter</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For writing files to an SMB share, and for XML <code>&lt;int-smb:outbound-channel-adapter&gt;</code> component we use the <code>SmbMessageHandler</code>.
In case of Java configuration a <code>SmbMessageHandler</code> should be supplied with the <code>SmbSessionFactory</code> (or <code>SmbRemoteFileTemplate</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Bean
@ServiceActivator(inputChannel = "storeToSmbShare")
public MessageHandler smbMessageHandler(SmbSessionFactory smbSessionFactory) {
    SmbMessageHandler handler = new SmbMessageHandler(smbSessionFactory);
    handler.setRemoteDirectoryExpression(
        new LiteralExpression("remote-target-dir"));
    handler.setFileNameGenerator(m -&gt;
        m.getHeaders().get(FileHeaders.FILENAME, String.class) + ".test");
    handler.setAutoCreateDirectory(true);
    return handler;
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="inbound-channel-java-dsl"><a class="anchor" href="#inbound-channel-java-dsl"></a>Configuring with the Java DSL</h3>
<div class="paragraph">
<p>The following Spring Boot application shows an example of how to configure the outbound adapter using the Java DSL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootApplication
@IntegrationComponentScan
public class SmbJavaApplication {

    public static void main(String[] args) {
        ConfigurableApplicationContext context =
            new SpringApplicationBuilder(SmbJavaApplication.class)
                .web(false)
                .run(args);
        MyGateway gateway = context.getBean(MyGateway.class);
        gateway.sendToSmb(new File("/foo/bar.txt"));
    }

    @Bean
    public SmbSessionFactory smbSessionFactory() {
        SmbSessionFactory smbSession = new SmbSessionFactory();
        smbSession.setHost("myHost");
        smbSession.setPort(445);
        smbSession.setDomain("myDomain");
        smbSession.setUsername("myUser");
        smbSession.setPassword("myPassword");
        smbSession.setShareAndDir("myShareAndDir");
        smbSession.setSmbMinVersion(DialectVersion.SMB210);
        smbSession.setSmbMaxVersion(DialectVersion.SMB311);
        return smbSession;
    }

    @Bean
    public IntegrationFlow smbOutboundFlow() {
        return IntegrationFlow.from("toSmbChannel")
                .handle(Smb.outboundAdapter(smbSessionFactory(), FileExistsMode.REPLACE)
                        .useTemporaryFileName(false)
                        .fileNameExpression("headers['" + FileHeaders.FILENAME + "']")
                        .remoteDirectory("smbTarget")
                ).get();
    }

    @MessagingGateway
    public interface MyGateway {

         @Gateway(requestChannel = "toSmbChannel")
         void sendToSmb(File file);
    }

}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smb-outbound-gateway"><a class="anchor" href="#smb-outbound-gateway"></a>SMB Outbound Gateway</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The SMB outbound gateway provides a limited set of commands to interact with a remote SMB server.
The supported commands are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ls</code> (list files)</p>
</li>
<li>
<p><code>nlst</code> (list file names)</p>
</li>
<li>
<p><code>get</code> (retrieve file)</p>
</li>
<li>
<p><code>mget</code> (retrieve file(s))</p>
</li>
<li>
<p><code>rm</code> (remove file(s))</p>
</li>
<li>
<p><code>mv</code> (move/rename file)</p>
</li>
<li>
<p><code>put</code> (send file)</p>
</li>
<li>
<p><code>mput</code> (send multiple files)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="using-the-ls-command"><a class="anchor" href="#using-the-ls-command"></a>Using the <code>ls</code> Command</h3>
<div class="paragraph">
<p><code>ls</code> lists remote files and supports the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-1</code>: Retrieve a list of filenames.
The default is to retrieve a list of <code>FileInfo</code> objects</p>
</li>
<li>
<p><code>-a</code>: Include all files (including those starting with '.')</p>
</li>
<li>
<p><code>-f</code>: Do not sort the list</p>
</li>
<li>
<p><code>-dirs</code>: Include directories (excluded by default)</p>
</li>
<li>
<p><code>-links</code>: Include symbolic links (excluded by default)</p>
</li>
<li>
<p><code>-R</code>: List the remote directory recursively</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition, filename filtering is provided in the same manner as the <code>inbound-channel-adapter</code>.</p>
</div>
<div class="paragraph">
<p>The message payload resulting from an <code>ls</code> operation is a list of file names or a list of <code>FileInfo</code> objects (depending on whether you usr the <code>-1</code> switch).
These objects provide information such as modified time, permissions, and others.</p>
</div>
<div class="paragraph">
<p>The remote directory that the <code>ls</code> command acted on is provided in the <code>file_remoteDirectory</code> header.</p>
</div>
<div class="paragraph">
<p>When using the recursive option (<code>-R</code>), the <code>fileName</code> includes any subdirectory elements and represents the relative path to the file (relative to the remote directory).
If you use the <code>-dirs</code> option, each recursive directory is also returned as an element in the list.
In this case, we recommend that you not use the <code>-1</code> option, because you would not be able to distinguish files from directories, which you can do when you use <code>FileInfo</code> objects.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-nlst-command"><a class="anchor" href="#using-nlst-command"></a>Using <code>nlst</code> Command</h3>
<div class="paragraph">
<p><code>nlst</code> lists remote file names and supports only one option:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-f</code>: Do not sort the list</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The message payload resulting from an <code>nlst</code> operation is a list of file names.</p>
</div>
<div class="paragraph">
<p>The <code>file_remoteDirectory</code> header holds the remote directory on which the <code>nlst</code> command acted.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-get-command"><a class="anchor" href="#using-the-get-command"></a>Using the <code>get</code> Command</h3>
<div class="paragraph">
<p><code>get</code> retrieves a remote file and supports the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-P</code>: Preserve the timestamp of the remote file.</p>
</li>
<li>
<p><code>-stream</code>: Retrieve the remote file as a stream.</p>
</li>
<li>
<p><code>-D</code>: Delete the remote file after successful transfer.
The remote file is not deleted if the transfer is ignored, because the <code>FileExistsMode</code> is <code>IGNORE</code> and the local file already exists.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>file_remoteDirectory</code> header holds the remote directory, and the <code>file_remoteFile</code> header holds the filename.</p>
</div>
<div class="paragraph">
<p>The message payload resulting from a <code>get</code> operation is a <code>File</code> object representing the retrieved file.
If you use the <code>-stream</code> option, the payload is an <code>InputStream</code> rather than a <code>File</code>.
For text files, a common use case is to combine this operation with a <a href="file/splitter.html" class="xref page">file splitter</a> or a <a href="transformer.html#stream-transformer" class="xref page">stream transformer</a>.
When consuming remote files as streams, you are responsible for closing the <code>Session</code> after the stream is consumed.
For convenience, the <code>Session</code> is provided in the <code>closeableResource</code> header, and <code>IntegrationMessageHeaderAccessor</code> offers convenience method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Closeable closeable = new IntegrationMessageHeaderAccessor(message).getCloseableResource();
if (closeable != null) {
    closeable.close();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Framework components, such as the <a href="file/splitter.html" class="xref page">File Splitter</a> and <a href="transformer.html#stream-transformer" class="xref page">Stream Transformer</a>, automatically close the session after the data is transferred.</p>
</div>
<div class="paragraph">
<p>The following example shows how to consume a file as a stream:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;int-smb:outbound-gateway session-factory="smbSessionFactory"
                            request-channel="inboundGetStream"
                            command="get"
                            command-options="-stream"
                            expression="payload"
                            remote-directory="smbTarget"
                            reply-channel="stream" /&gt;

&lt;int-file:splitter input-channel="stream" output-channel="lines" /&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you consume the input stream in a custom component, you must close the <code>Session</code>.
You can either do that in your custom code or route a copy of the message to a <code>service-activator</code> and use SpEL, as the following example shows:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;int:service-activator input-channel="closeSession"
    expression="headers['closeableResource'].close()" /&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-the-mget-command"><a class="anchor" href="#using-the-mget-command"></a>Using the <code>mget</code> Command</h3>
<div class="paragraph">
<p><code>mget</code> retrieves multiple remote files based on a pattern and supports the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-P</code>: Preserve the timestamps of the remote files.</p>
</li>
<li>
<p><code>-R</code>: Retrieve the entire directory tree recursively.</p>
</li>
<li>
<p><code>-x</code>: Throw an exception if no files match the pattern (otherwise, an empty list is returned).</p>
</li>
<li>
<p><code>-D</code>: Delete each remote file after successful transfer.
If the transfer is ignored, the remote file is not deleted, because the <code>FileExistsMode</code> is <code>IGNORE</code> and the local file already exists.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The message payload resulting from an <code>mget</code> operation is a <code>List&lt;File&gt;</code> object (that is, a <code>List</code> of <code>File</code> objects, each representing a retrieved file).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If the <code>FileExistsMode</code> is <code>IGNORE</code>, the payload of the output message no longer contain files that were not fetched due to the file already existing.
Previously, the array contained all files, including those that already existed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The expression you use determine the remote path should produce a result that ends with <code><strong></code> for example <code>myfiles/</strong></code> fetches the complete tree under <code>myfiles</code>.</p>
</div>
<div class="paragraph">
<p>You can use a recursive <code>MGET</code>, combined with the <code>FileExistsMode.REPLACE_IF_MODIFIED</code> mode, to periodically synchronize an entire remote directory tree locally.
This mode sets the local file&#8217;s last modified timestamp to the remote file&#8217;s timestamp, regardless of the <code>-P</code> (preserve timestamp) option.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Notes for when using recursion (<code>-R</code>)</div>
<div class="paragraph">
<p>The pattern is ignored and <code>*</code> is assumed.
By default, the entire remote tree is retrieved.
However, you can filter files in the tree by providing a <code>FileListFilter</code>.
You can also filter directories in the tree this way.
A <code>FileListFilter</code> can be provided by reference or by <code>filename-pattern</code> or <code>filename-regex</code> attributes.
For example, <code>filename-regex="(subDir|.*1.txt)"</code> retrieves all files ending with <code>1.txt</code> in the remote directory and the subdirectory <code>subDir</code>.
However, we describe an alternative available after this note.</p>
</div>
<div class="paragraph">
<p>If you filter a subdirectory, no additional traversal of that subdirectory is performed.</p>
</div>
<div class="paragraph">
<p>The <code>-dirs</code> option is not allowed (the recursive <code>mget</code> uses the recursive <code>ls</code> to obtain the directory tree and the directories themselves cannot be included in the list).</p>
</div>
<div class="paragraph">
<p>Typically, you would use the <code>#remoteDirectory</code> variable in the <code>local-directory-expression</code> so that the remote directory structure is retained locally.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The persistent file list filters now have a boolean property <code>forRecursion</code>.
Setting this property to <code>true</code>, also sets <code>alwaysAcceptDirectories</code>, which means that the recursive operation on the outbound gateways (<code>ls</code> and <code>mget</code>) will now always traverse the full directory tree each time.
This is to solve a problem where changes deep in the directory tree were not detected.
In addition, <code>forRecursion=true</code> causes the full path to files to be used as the metadata store keys; this solves a problem where the filter did not work properly if a file with the same name appears multiple times in different directories.
IMPORTANT: This means that existing keys in a persistent metadata store will not be found for files beneath the top level directory.
For this reason, the property is <code>false</code> by default; this may change in a future release.</p>
</div>
<div class="paragraph">
<p>You can configure the <code>SmbSimplePatternFileListFilter</code> and <code>SmbRegexPatternFileListFilter</code> to always pass directories by setting the <code>alwaysAcceptDirectorties</code> to <code>true</code>.
Doing so allows recursion for a simple pattern, as the following examples show:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="starDotTxtFilter"
            class="org.springframework.integration.smb.filters.SmbSimplePatternFileListFilter"&gt;
    &lt;constructor-arg value="*.txt" /&gt;
    &lt;property name="alwaysAcceptDirectories" value="true" /&gt;
&lt;/bean&gt;

&lt;bean id="dotStarDotTxtFilter"
            class="org.springframework.integration.smb.filters.SmbRegexPatternFileListFilter"&gt;
    &lt;constructor-arg value="^.*\.txt$" /&gt;
    &lt;property name="alwaysAcceptDirectories" value="true" /&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can provide one of these filters by using the <code>filter</code> property on the gateway.</p>
</div>
<div class="paragraph">
<p>See also <a href="#smb-partial">Outbound Gateway Partial Success (<code>mget</code> and <code>mput</code>)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="smb-put-command"><a class="anchor" href="#smb-put-command"></a>Using the <code>put</code> Command</h3>
<div class="paragraph">
<p><code>put</code> sends a file to the remote server.
The payload of the message can be a <code>java.io.File</code>, a <code>byte[]</code>, or a <code>String</code>.
A <code>remote-filename-generator</code> (or expression) is used to name the remote file.
Other available attributes include <code>remote-directory</code>, <code>temporary-remote-directory</code> and their <code>*-expression</code> equivalents: <code>use-temporary-file-name</code> and <code>auto-create-directory</code>.
See the <a href="https://github.com/spring-projects/spring-integration/tree/main/spring-integration-core/src/main/resources/org/springframework/integration/config">schema documentation</a> for more information.</p>
</div>
<div class="paragraph">
<p>The message payload resulting from a <code>put</code> operation is a <code>String</code> that contains the full path of the file on the server after transfer.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-mput-command"><a class="anchor" href="#using-the-mput-command"></a>Using the <code>mput</code> Command</h3>
<div class="paragraph">
<p><code>mput</code> sends multiple files to the server and supports the following option:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-R</code>: Recursive&#8201;&#8212;&#8201;send all files (possibly filtered) in the directory and subdirectories</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The message payload must be a <code>java.io.File</code> (or <code>String</code>) that represents a local directory.
A collection of <code>File</code> or <code>String</code> is also supported.</p>
</div>
<div class="paragraph">
<p>The same attributes as the <a href="#smb-put-command"><code>put</code> command</a> are supported.
In addition, you can filter files in the local directory with one of <code>mput-pattern</code>, <code>mput-regex</code>, <code>mput-filter</code>, or <code>mput-filter-expression</code>.
The filter works with recursion, as long as the subdirectories themselves pass the filter.
Subdirectories that do not pass the filter are not recursed.</p>
</div>
<div class="paragraph">
<p>The message payload resulting from an <code>mput</code> operation is a <code>List&lt;String&gt;</code> object (that is, a <code>List</code> of remote file paths resulting from the transfer).</p>
</div>
<div class="paragraph">
<p>See also <a href="#smb-partial">Outbound Gateway Partial Success (<code>mget</code> and <code>mput</code>)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-rm-command"><a class="anchor" href="#using-the-rm-command"></a>Using the <code>rm</code> Command</h3>
<div class="paragraph">
<p>The <code>rm</code> command has no options.</p>
</div>
<div class="paragraph">
<p>If the remove operation was successful, the resulting message payload is <code>Boolean.TRUE</code>.
Otherwise, the message payload is <code>Boolean.FALSE</code>.
The <code>file_remoteDirectory</code> header holds the remote directory, and the <code>file_remoteFile</code> header holds the file name.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-mv-command"><a class="anchor" href="#using-the-mv-command"></a>Using the <code>mv</code> Command</h3>
<div class="paragraph">
<p>The <code>mv</code> command has no options.</p>
</div>
<div class="paragraph">
<p>The <code>expression</code> attribute defines the &#8220;from&#8221; path, and the <code>rename-expression</code> attribute defines the &#8220;to&#8221; path.
By default, the <code>rename-expression</code> is <code>headers['file_renameTo']</code>.
This expression must not evaluate to null or an empty <code>String</code>.
If necessary, any remote directories needed are created.
The payload of the result message is <code>Boolean.TRUE</code>.
The <code>file_remoteDirectory</code> header holds the original remote directory, and the <code>file_remoteFile</code> header holds the filename.
The <code>file_renameTo</code> header holds the new path.</p>
</div>
<div class="paragraph">
<p>The <code>remoteDirectoryExpression</code> can be used in the <code>mv</code> command for convenience.
If the &#8220;from&#8221; file is not a full file path, the result of <code>remoteDirectoryExpression</code> is used as the remote directory.
The same applies for the &#8220;to&#8221; file, for example, if the task is just to rename a remote file in some directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="additional-command-information"><a class="anchor" href="#additional-command-information"></a>Additional Command Information</h3>
<div class="paragraph">
<p>The <code>get</code> and <code>mget</code> commands support the <code>local-filename-generator-expression</code> attribute.
It defines a SpEL expression to generate the names of local files during the transfer.
The root object of the evaluation context is the request message.
The <code>remoteFileName</code> variable is also available.
It is particularly useful for <code>mget</code> (for example: <code>local-filename-generator-expression="#remoteFileName.toUpperCase() + headers.foo"</code>).</p>
</div>
<div class="paragraph">
<p>The <code>get</code> and <code>mget</code> commands support the <code>local-directory-expression</code> attribute.
It defines a SpEL expression to generate the names of local directories during the transfer.
The root object of the evaluation context is the request message.
The <code>remoteDirectory</code> variable is also available.
It is particularly useful for mget (for example: <code>local-directory-expression="'/tmp/local/' + #remoteDirectory.toUpperCase() + headers.myheader"</code>).
This attribute is mutually exclusive with the <code>local-directory</code> attribute.</p>
</div>
<div class="paragraph">
<p>For all commands, the 'expression' property of the gateway holds the path on which the command acts.
For the <code>mget</code> command, the expression might evaluate to <code><strong></code>, meaning to retrieve all files, <code>somedirectory/</strong></code>, and other values that end with <code>*</code>.</p>
</div>
<div class="paragraph">
<p>The following example shows a gateway configured for an <code>ls</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;int-smb:outbound-gateway id="gateway1"
        session-factory="smbSessionFactory"
        request-channel="inbound1"
        command="ls"
        command-options="-1"
        expression="payload"
        reply-channel="toSplitter"/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The payload of the message sent to the <code>toSplitter</code> channel is a list of <code>String</code> objects, each of which contains the name of a file.
If you omitted <code>command-options="-1"</code>, the payload would be a list of <code>FileInfo</code> objects.
You can provide options as a space-delimited list (for example, <code>command-options="-1 -dirs -links"</code>).</p>
</div>
<div class="paragraph">
<p>The <code>GET</code>, <code>MGET</code>, <code>PUT</code>, and <code>MPUT</code> commands support a <code>FileExistsMode</code> property (<code>mode</code> when using the namespace support).
This affects the behavior when the local file exists (<code>GET</code> and <code>MGET</code>) or the remote file exists (<code>PUT</code> and <code>MPUT</code>).
The supported modes are <code>REPLACE</code>, <code>APPEND</code>, <code>FAIL</code>, and <code>IGNORE</code>.
For backwards compatibility, the default mode for <code>PUT</code> and <code>MPUT</code> operations is <code>REPLACE</code>.
For <code>GET</code> and <code>MGET</code> operations, the default is <code>FAIL</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-with-java-configuration"><a class="anchor" href="#configuring-with-java-configuration"></a>Configuring with Java Configuration</h3>
<div class="paragraph">
<p>The following Spring Boot application shows an example of how to configure the outbound gateway with Java configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootApplication
public class SmbJavaApplication {

    public static void main(String[] args) {
        new SpringApplicationBuilder(SmbJavaApplication.class)
            .web(false)
            .run(args);
    }

    @Bean
    public SmbSessionFactory smbSessionFactory() {
        SmbSessionFactory smbSession = new SmbSessionFactory();
        smbSession.setHost("myHost");
        smbSession.setPort(445);
        smbSession.setDomain("myDomain");
        smbSession.setUsername("myUser");
        smbSession.setPassword("myPassword");
        smbSession.setShareAndDir("myShareAndDir");
        smbSession.setSmbMinVersion(DialectVersion.SMB210);
        smbSession.setSmbMaxVersion(DialectVersion.SMB311);
        return smbSession;
    }

    @Bean
    @ServiceActivator(inputChannel = "smbChannel")
    public MessageHandler handler() {
        SmbOutboundGateway smbOutboundGateway =
            new SmbOutboundGateway(smbSessionFactory(), "'my_remote_dir/'");
        smbOutboundGateway.setOutputChannelName("replyChannel");
        return smbOutboundGateway;
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="outbound-gateway-java-dsl"><a class="anchor" href="#outbound-gateway-java-dsl"></a>Configuring with the Java DSL</h3>
<div class="paragraph">
<p>The following Spring Boot application shows an example of how to configure the outbound gateway with the Java DSL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootApplication
public class SmbJavaApplication {

    public static void main(String[] args) {
        new SpringApplicationBuilder(SmbJavaApplication.class)
            .web(false)
            .run(args);
    }

    @Bean
    public SmbSessionFactory smbSessionFactory() {
        SmbSessionFactory smbSession = new SmbSessionFactory();
        smbSession.setHost("myHost");
        smbSession.setPort(445);
        smbSession.setDomain("myDomain");
        smbSession.setUsername("myUser");
        smbSession.setPassword("myPassword");
        smbSession.setShareAndDir("myShareAndDir");
        smbSession.setSmbMinVersion(DialectVersion.SMB210);
        smbSession.setSmbMaxVersion(DialectVersion.SMB311);
        return smbSession;
    }

    @Bean
    public SmbOutboundGatewaySpec smbOutboundGateway() {
        return Smb.outboundGateway(smbSessionFactory(),
            AbstractRemoteFileOutboundGateway.Command.MGET, "payload")
            .options(AbstractRemoteFileOutboundGateway.Option.RECURSIVE)
            .regexFileNameFilter("(subSmbSource|.*.txt)")
            .localDirectoryExpression("'localDirectory/' + #remoteDirectory")
            .localFilenameExpression("#remoteFileName.replaceFirst('smbSource', 'localTarget')");
    }

    @Bean
    public IntegrationFlow smbFlow(AbstractRemoteFileOutboundGateway&lt;SmbFile&gt; smbOutboundGateway) {
        return f -&gt; f
            .handle(smbOutboundGateway)
            .channel(c -&gt; c.queue("remoteFileOutputChannel"));
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="smb-partial"><a class="anchor" href="#smb-partial"></a>Outbound Gateway Partial Success (<code>mget</code> and <code>mput</code>)</h3>
<div class="paragraph">
<p>When performing operations on multiple files (by using <code>mget</code> and <code>mput</code>) an exception can occur some time after one or more files have been transferred.
In this case a <code>PartialSuccessException</code> is thrown.
As well as the usual <code>MessagingException</code> properties (<code>failedMessage</code> and <code>cause</code>), this exception has two additional properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>partialResults</code>: The successful transfer results.</p>
</li>
<li>
<p><code>derivedInput</code>: The list of files generated from the request message (such as local files to transfer for an <code>mput</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These attributes let you determine which files were successfully transferred and which were not.</p>
</div>
<div class="paragraph">
<p>In the case of a recursive <code>mput</code>, the <code>PartialSuccessException</code> may have nested <code>PartialSuccessException</code> instances.</p>
</div>
<div class="paragraph">
<p>Consider the following directory structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">root/
|- file1.txt
|- subdir/
   | - file2.txt
   | - file3.txt
|- zoo.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the exception occurs on <code>file3.txt</code>, the <code>PartialSuccessException</code> thrown by the gateway has <code>derivedInput</code> of <code>file1.txt</code>, <code>subdir</code>, and <code>zoo.txt</code> and <code>partialResults</code> of <code>file1.txt</code>.
Its <code>cause</code> is another <code>PartialSuccessException</code> with <code>derivedInput</code> of <code>file2.txt</code> and <code>file3.txt</code> and <code>partialResults</code> of <code>file2.txt</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="smb-remote-file-info"><a class="anchor" href="#smb-remote-file-info"></a>Remote File Information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>SmbStreamingMessageSource</code> (<a href="#smb-streaming-inbound">SMB Streaming Inbound Channel Adapter</a>), <code>SmbInboundFileSynchronizingMessageSource</code> (<a href="#smb-inbound">SMB Inbound Channel Adapter</a>) and "read"-commands of the <code>SmbOutboundGateway</code> (<a href="#smb-outbound-gateway">SMB Outbound Gateway</a>) provide additional headers in the message to produce with an information about the remote file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FileHeaders.REMOTE_HOST_PORT</code> - the host:port pair the remote session has been connected to during file transfer operation;</p>
</li>
<li>
<p><code>FileHeaders.REMOTE_DIRECTORY</code> - the remote directory the operation has been performed;</p>
</li>
<li>
<p><code>FileHeaders.REMOTE_FILE</code> - the remote file name; applicable only for single file operations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since the <code>SmbInboundFileSynchronizingMessageSource</code> doesn&#8217;t produce messages against remote files, but using a local copy, the <code>AbstractInboundFileSynchronizer</code> stores an information about remote file in the <code>MetadataStore</code> (which can be configured externally) in the URI style (<code>protocol://host:port/remoteDirectory#remoteFileName</code>) during synchronization operation.
This metadata is retrieved by the <code>SmbInboundFileSynchronizingMessageSource</code> when local file is polled.
When local file is deleted, it is recommended to remove its metadata entry.
The <code>AbstractInboundFileSynchronizer</code> provides a <code>removeRemoteFileMetadata()</code> callback for this purpose.
In addition, there is a <code>setMetadataStorePrefix()</code> to be used in the metadata keys.
It is recommended to have this prefix be different from the one used in the <code>MetadataStore</code>-based <code>FileListFilter</code> implementations, when the same <code>MetadataStore</code> instance is shared between these components, to avoid entry overriding because both filter and <code>AbstractInboundFileSynchronizer</code> use the same local file name for the metadata entry key.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="sftp/remote-file-info.html">Remote File Information</a></span>
  <span class="next"><a href="stomp.html">STOMP Support</a></span>
</nav>
</article>
</div>  </div>
</main>
<div class="modal micromodal-slide" id="modal-versions" aria-hidden="true">
    <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true">
            <main class="modal__content" id="modal-versions-content">
              <button data-micromodal-close class="modal-versions-close">
                <svg width="28px" height="28px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><defs><style>.cls-1{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:2px;}</style></defs><title/><g id="cross"><line class="cls-1" x1="7" x2="25" y1="7" y2="25"/><line class="cls-1" x1="7" x2="25" y1="25" y2="7"/></g></svg>
              </button>
              <div class="colset">
                <div class="col-left">
                  <ul class="nav-versions">
                    <li class="component is-current">
                      <a class="title" href="index.html">Spring Integration</a>
                      <ul class="versions">
                        <li class="version is-current is-latest">
                          <a href="index.html">
                            6.2.0-SNAPSHOT<span class="current">current</span>
                          </a>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-right">
                  <ul>
                    <li>
                      Related Spring Documentation
                      <ul>
                        <li><a href="https://docs.spring.io/spring-framework/reference/">Spring Framework</a></li>
                        <li><a href="https://docs.spring.io/spring-security/reference/">Spring Security</a></li>
                        <li><a href="https://docs.spring.io/spring-ldap/reference/">Spring LDAP</a></li>
                        <li><a href="https://docs.spring.io/spring-session/reference/">Spring Session</a></li>
                        <li><a href="https://docs.spring.io/spring-authorization-server/reference/">Spring Authorization Server</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
              </div>
            </main>
        </div>
    </div>
</div>

</div>
<footer class="footer flex">
    <div id="spring-links flex">
        <img id="springlogo" src="./_/img/spring-logo.svg" alt="Spring">
        <p class="smallest antialiased">© <script>var d = new Date();
        document.write(d.getFullYear());</script> <a href="https://www.vmware.com/">VMware</a>, Inc. or its affiliates. <a href="https://www.vmware.com/help/legal.html">Terms of Use</a> • <a href="https://www.vmware.com/help/privacy.html" rel="noopener noreferrer">Privacy</a> • <a href="https://spring.io/trademarks">Trademark Guidelines</a> <span id="thank-you-mobile">• <a href="https://spring.io/thank-you">Thank you</a></span> • <a href="https://www.vmware.com/help/privacy/california-privacy-rights.html">Your California Privacy Rights</a> • <a class="ot-sdk-show-settings">Cookie Settings</a> <span id="teconsent"></span></p>
        <p class="smallest antialiased has-gray-text">Apache®, Apache Tomcat®, Apache Kafka®, Apache Cassandra&trade;, and Apache Geode&trade; are trademarks or registered trademarks of the Apache Software Foundation in the United States and/or other countries. Java&trade;, Java&trade; SE, Java&trade; EE, and OpenJDK&trade; are trademarks of Oracle and/or its affiliates. Kubernetes® is a registered trademark of the Linux Foundation in the United States and other countries. Linux® is the registered trademark of Linus Torvalds in the United States and other countries. Windows® and Microsoft® Azure are registered trademarks of Microsoft Corporation. “AWS” and “Amazon Web Services” are trademarks or registered trademarks of Amazon.com Inc. or its affiliates. All other trademarks and copyrights are property of their respective owners and are only mentioned for informative purposes. Other names may be trademarks of their respective owners.</p>
    </div>
    <div id="social-icons" class="flex jc-between">
        <a href="https://www.youtube.com/user/SpringSourceDev" title="Youtube"><svg id="youtube-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><circle class="cls-1" cx="20" cy="20" r="20"/><path class="cls-2" d="M30.91,14.53a2.89,2.89,0,0,0-2-2C27.12,12,20,12,20,12s-7.12,0-8.9.47a2.9,2.9,0,0,0-2,2A30.56,30.56,0,0,0,8.63,20a30.44,30.44,0,0,0,.46,5.47,2.89,2.89,0,0,0,2,2C12.9,28,20,28,20,28s7.12,0,8.9-.47a2.87,2.87,0,0,0,2-2A30.56,30.56,0,0,0,31.37,20,28.88,28.88,0,0,0,30.91,14.53ZM17.73,23.41V16.59L23.65,20Z"/></svg></a>
        <a href="https://github.com/spring-projects" title="Github"><svg id="github-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 75.93 75.93"><path class="cls-1" d="M38,0a38,38,0,1,0,38,38A38,38,0,0,0,38,0Z"/></g><path class="cls-2" d="M38,15.59A22.95,22.95,0,0,0,30.71,60.3c1.15.21,1.57-.5,1.57-1.11s0-2,0-3.9c-6.38,1.39-7.73-3.07-7.73-3.07A6.09,6.09,0,0,0,22,48.86c-2.09-1.42.15-1.39.15-1.39a4.81,4.81,0,0,1,3.52,2.36c2,3.5,5.37,2.49,6.67,1.91a4.87,4.87,0,0,1,1.46-3.07c-5.09-.58-10.45-2.55-10.45-11.34a8.84,8.84,0,0,1,2.36-6.15,8.29,8.29,0,0,1,.23-6.07s1.92-.62,6.3,2.35a21.82,21.82,0,0,1,11.49,0c4.38-3,6.3-2.35,6.3-2.35a8.29,8.29,0,0,1,.23,6.07,8.84,8.84,0,0,1,2.36,6.15c0,8.81-5.37,10.75-10.48,11.32a5.46,5.46,0,0,1,1.56,4.25c0,3.07,0,5.54,0,6.29s.42,1.33,1.58,1.1A22.94,22.94,0,0,0,38,15.59Z"/></svg></a>
        <a href="https://twitter.com/springcentral" title="Twitter"><svg id="twitter-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 75.93 75.93"><circle class="cls-1" cx="37.97" cy="37.97" r="37.97"/><path id="Twitter-2" data-name="Twitter" class="cls-2" d="M55.2,22.73a15.43,15.43,0,0,1-4.88,1.91,7.56,7.56,0,0,0-5.61-2.49A7.78,7.78,0,0,0,37,30a7.56,7.56,0,0,0,.2,1.79,21.63,21.63,0,0,1-15.84-8.23,8,8,0,0,0,2.37,10.52,7.66,7.66,0,0,1-3.48-1v.09A7.84,7.84,0,0,0,26.45,41a7.54,7.54,0,0,1-2,.28A7.64,7.64,0,0,1,23,41.09a7.71,7.71,0,0,0,7.18,5.47,15.21,15.21,0,0,1-9.55,3.37,15.78,15.78,0,0,1-1.83-.11,21.41,21.41,0,0,0,11.78,3.54c14.13,0,21.86-12,21.86-22.42,0-.34,0-.68,0-1a15.67,15.67,0,0,0,3.83-4.08,14.9,14.9,0,0,1-4.41,1.24A7.8,7.8,0,0,0,55.2,22.73Z"/></svg></a>
    </div>
</footer>
<script src="./_/js/vendor/import.js"></script>
<script src="./_/js/site.js"></script>
<script async src="./_/js/vendor/highlight.js"></script>
<script async src="./_/js/vendor/asciidoctor-tabs.js" data-sync-storage-key="docs:preferred-tab"></script>

<div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
    <div class="modal__overlay" tabindex="-1" data-micromodal-close>
        <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
            <main class="modal__content" id="modal-1-content">
                <div id="searchbox"></div>
                <div id="counter"></div>
                <div class="search-by">
                    <a target="_blank" rel="noopener noreferrer" href="https://www.algolia.com/" aria-label="Search by Algolia">
                        <img class="light" width="140" src="./_/img/algolia-light.svg" />
                        <img class="dark" width="140" src="./_/img/algolia-dark.svg" />
                    </a>
                </div>
                <div id="hits"></div>
            </main>
        </div>
    </div>
</div>

<script src="https://unpkg.com/hotkeys-js/dist/hotkeys.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.17.0/dist/algoliasearch-lite.umd.js" integrity="sha256-Lf9DrpGmcRip6OQzbcL6lnvNmoZNSKpyQX5pMlwatWE=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.54.1/dist/instantsearch.production.min.js" integrity="sha256-xYsZPDeNjYNTBWLvqD2Lxe98hOxcDgOHyMPfz4tVAbk=" crossorigin="anonymous"></script>
<script async id="search-script" src="./_/js/vendor/search.js" data-app-id="WB1FQYI187" data-api-key="9d489079e5ec46dbb238909fee5c9c29" data-index-name="springintegration" data-stylesheet="./_/css/vendor/search.css" data-page-version="6.2.0"></script>

  </body>
</html>
